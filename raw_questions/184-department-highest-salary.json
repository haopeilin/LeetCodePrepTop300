{
    "questionId": "184",
    "questionFrontendId": "184",
    "title": "Department Highest Salary",
    "titleSlug": "department-highest-salary",
    "content": "<p>Table: <code>Employee</code></p>\n\n<pre>\n+--------------+---------+\n| Column Name  | Type    |\n+--------------+---------+\n| id           | int     |\n| name         | varchar |\n| salary       | int     |\n| departmentId | int     |\n+--------------+---------+\nid is the primary key (column with unique values) for this table.\ndepartmentId is a foreign key (reference columns) of the ID from the <code>Department </code>table.\nEach row of this table indicates the ID, name, and salary of an employee. It also contains the ID of their department.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Table: <code>Department</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| id          | int     |\n| name        | varchar |\n+-------------+---------+\nid is the primary key (column with unique values) for this table. It is guaranteed that department name is not <code>NULL.</code>\nEach row of this table indicates the ID of a department and its name.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write a solution to find employees who have the highest salary in each of the departments.</p>\n\n<p>Return the result table in <strong>any order</strong>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nEmployee table:\n+----+-------+--------+--------------+\n| id | name  | salary | departmentId |\n+----+-------+--------+--------------+\n| 1  | Joe   | 70000  | 1            |\n| 2  | Jim   | 90000  | 1            |\n| 3  | Henry | 80000  | 2            |\n| 4  | Sam   | 60000  | 2            |\n| 5  | Max   | 90000  | 1            |\n+----+-------+--------+--------------+\nDepartment table:\n+----+-------+\n| id | name  |\n+----+-------+\n| 1  | IT    |\n| 2  | Sales |\n+----+-------+\n<strong>Output:</strong> \n+------------+----------+--------+\n| Department | Employee | Salary |\n+------------+----------+--------+\n| IT         | Jim      | 90000  |\n| Sales      | Henry    | 80000  |\n| IT         | Max      | 90000  |\n+------------+----------+--------+\n<strong>Explanation:</strong> Max and Jim both have the highest salary in the IT department and Henry has the highest salary in the Sales department.\n</pre>\n",
    "difficulty": "Medium",
    "stats": "{\"totalAccepted\": \"630.7K\", \"totalSubmission\": \"1.1M\", \"totalAcceptedRaw\": 630662, \"totalSubmissionRaw\": 1102127, \"acRate\": \"57.2%\"}",
    "hints": [],
    "similarQuestions": "[{\"title\": \"Highest Grade For Each Student\", \"titleSlug\": \"highest-grade-for-each-student\", \"difficulty\": \"Medium\", \"translatedTitle\": null}]",
    "topicTags": [
        {
            "name": "Database",
            "slug": "database"
        }
    ],
    "companyTags": null,
    "codeSnippets": [],
    "solution": {
        "content": "<h1><a href=\"#solution\"><svg><path></path></svg></a>Solution</h1>\n<hr/>\n<h2><a href=\"#pandas\"><svg><path></path></svg></a>pandas</h2>\n<h3><a href=\"#approach-left-join\"><svg><path></path></svg></a>Approach: Left Join</h3>\n<h4>Algorithm</h4>\n<p>We start by merging two tables to obtain all the department names, employee names, and salaries.</p>\n<pre><code>// Perform a left join between employee and department tables\nList&lt;Map&lt;String, Object&gt;&gt; df = new ArrayList&lt;&gt;();\nfor (Map&lt;String, Object&gt; emp : employee) {\n    Map&lt;String, Object&gt; row = new HashMap&lt;&gt;(emp);\n    Integer deptId = (Integer) emp.get(\"departmentId\");\n    for (Map&lt;String, Object&gt; dept : department) {\n        if (dept.get(\"id\").equals(deptId)) {\n            row.putAll(dept);\n            break;\n        }\n    }\n    df.add(row);\n}</code></pre><svg><path></path></svg>\n<table><thead><tr><th>id_x</th><th>name_x</th><th>salary</th><th>departmentId</th><th>id_y</th><th>name_y</th></tr></thead><tbody><tr><td>1</td><td>Joe</td><td>70000</td><td>1</td><td>1</td><td>IT</td></tr><tr><td>2</td><td>Jim</td><td>90000</td><td>1</td><td>1</td><td>IT</td></tr><tr><td>3</td><td>Henry</td><td>80000</td><td>2</td><td>2</td><td>Sales</td></tr><tr><td>4</td><td>Sam</td><td>60000</td><td>2</td><td>2</td><td>Sales</td></tr><tr><td>5</td><td>Max</td><td>90000</td><td>1</td><td>1</td><td>IT</td></tr></tbody></table>\n<blockquote>\n<p>Note that after the merge, columns with the same name (for example, <code>name</code>) in the original tables will be renamed (as <code>name_x</code> and <code>name_y</code>), so we need to perform column renaming.</p>\n</blockquote>\n<pre><code>// Rename columns\nfor (Map&lt;String, Object&gt; row : df) {\n    row.put(\"Employee\", row.remove(\"name_x\"));\n    row.put(\"Department\", row.remove(\"name_y\"));\n    row.put(\"Salary\", row.remove(\"salary\"));\n}</code></pre><svg><path></path></svg>\n<p>The resulting <code>df</code> will be as follows.</p>\n<table><thead><tr><th>id_x</th><th>Employee</th><th>Salary</th><th>departmentId</th><th>id_y</th><th>Department</th></tr></thead><tbody><tr><td>1</td><td>Joe</td><td>70000</td><td>1</td><td>1</td><td>IT</td></tr><tr><td>2</td><td>Jim</td><td>90000</td><td>1</td><td>1</td><td>IT</td></tr><tr><td>3</td><td>Henry</td><td>80000</td><td>2</td><td>2</td><td>Sales</td></tr><tr><td>4</td><td>Sam</td><td>60000</td><td>2</td><td>2</td><td>Sales</td></tr><tr><td>5</td><td>Max</td><td>90000</td><td>1</td><td>1</td><td>IT</td></tr></tbody></table>\n<p>Next, we group <code>df</code> based on the <code>Department</code> column and apply the function <code>transform('max')</code> to the <code>Salary</code> column, which calculates the maximum salary for each department and returns a Series of the same length, with each value being the maximum salary for the corresponding department (it may not necessarily be the salary of the corresponding employee.).</p>\n<pre><code>// Compute maximum salary per department\nMap&lt;String, Integer&gt; maxSalary = new HashMap&lt;&gt;();\nfor (Map&lt;String, Object&gt; row : df) {\n    String dept = (String) row.get(\"Department\");\n    Integer salary = (Integer) row.get(\"Salary\");\n    maxSalary.put(dept, Math.max(maxSalary.getOrDefault(dept, 0), salary));\n}</code></pre><svg><path></path></svg>\n<pre><code>// Resulting maximum salaries aligned with each row\nList&lt;Integer&gt; maxSalaryList = new ArrayList&lt;&gt;();\nfor (Map&lt;String, Object&gt; row : df) {\n    maxSalaryList.add(maxSalary.get(row.get(\"Department\")));\n}</code></pre><svg><path></path></svg>\n<br/>\n<p>Therefore, by using <code>df[df['salary'] == max_salary]</code>, we can select all the employees whose salary is equal to the maximum salary within their respective departments.</p>\n<pre><code>// Filter rows with salary equal to department maximum\nList&lt;Map&lt;String, Object&gt;&gt; filtered = new ArrayList&lt;&gt;();\nfor (Map&lt;String, Object&gt; row : df) {\n    if (row.get(\"Salary\").equals(maxSalary.get(row.get(\"Department\")))) {\n        filtered.add(row);\n    }\n}</code></pre><svg><path></path></svg>\n<p>We will obtain the following DataFrame <code>df</code>:</p>\n<table><thead><tr><th>id_x</th><th>Employee</th><th>Salary</th><th>departmentId</th><th>id_y</th><th>Department</th></tr></thead><tbody><tr><td>1</td><td>Jim</td><td>90000</td><td>1</td><td>1</td><td>IT</td></tr><tr><td>2</td><td>Henry</td><td>80000</td><td>2</td><td>2</td><td>Sales</td></tr><tr><td>4</td><td>Max</td><td>90000</td><td>1</td><td>1</td><td>IT</td></tr></tbody></table>\n<br/>\n<p>The last step is to return the dataframe that only contains the required columns, the complete code is as follows.</p>\n<h4>Implementation</h4>\n<pre><code>public List&lt;Map&lt;String, Object&gt;&gt; departmentHighestSalary(\n        List&lt;Map&lt;String, Object&gt;&gt; employee,\n        List&lt;Map&lt;String, Object&gt;&gt; department) {\n\n    // Merge tables\n    List&lt;Map&lt;String, Object&gt;&gt; df = new ArrayList&lt;&gt;();\n    for (Map&lt;String, Object&gt; emp : employee) {\n        Map&lt;String, Object&gt; row = new HashMap&lt;&gt;(emp);\n        Integer deptId = (Integer) emp.get(\"departmentId\");\n        for (Map&lt;String, Object&gt; dept : department) {\n            if (dept.get(\"id\").equals(deptId)) {\n                row.putAll(dept);\n                break;\n            }\n        }\n        row.put(\"Employee\", row.remove(\"name_x\"));\n        row.put(\"Department\", row.remove(\"name_y\"));\n        row.put(\"Salary\", row.remove(\"salary\"));\n        df.add(row);\n    }\n\n    // Compute maximum salary per department\n    Map&lt;String, Integer&gt; maxSalary = new HashMap&lt;&gt;();\n    for (Map&lt;String, Object&gt; row : df) {\n        String dept = (String) row.get(\"Department\");\n        Integer salary = (Integer) row.get(\"Salary\");\n        maxSalary.put(dept, Math.max(maxSalary.getOrDefault(dept, 0), salary));\n    }\n\n    // Filter and select required columns\n    List&lt;Map&lt;String, Object&gt;&gt; result = new ArrayList&lt;&gt;();\n    for (Map&lt;String, Object&gt; row : df) {\n        if (row.get(\"Salary\").equals(maxSalary.get(row.get(\"Department\")))) {\n            Map&lt;String, Object&gt; out = new HashMap&lt;&gt;();\n            out.put(\"Department\", row.get(\"Department\"));\n            out.put(\"Employee\", row.get(\"Employee\"));\n            out.put(\"Salary\", row.get(\"Salary\"));\n            result.add(out);\n        }\n    }\n    return result;\n}</code></pre>\n<br/>\n<hr/>\n<h2><a href=\"#database\"><svg><path></path></svg></a>Database</h2>\n<h3><a href=\"#approach-left-join-and-where-clause\"><svg><path></path></svg></a>Approach: <code>Left Join</code> and <code>WHERE</code> Clause</h3>\n<h4>Algorithm</h4>\n<p>Since the <strong>Employee</strong> table contains the <em>Salary</em> and <em>DepartmentId</em> information, we can query the highest salary in a department.</p>\n<pre><code>// SQL query represented as a Java string\nString sql = \n    \"SELECT DepartmentId, MAX(Salary) \" +\n    \"FROM Employee \" +\n    \"GROUP BY DepartmentId\";</code></pre><svg><path></path></svg>\n<blockquote>\n<p>Note: There might be multiple employees having the same highest salary, so it is safe not to include the employee name information in this query.</p>\n</blockquote>\n<table><thead><tr><th>DepartmentId</th><th>MAX(Salary)</th></tr></thead><tbody><tr><td>1</td><td>90000</td></tr><tr><td>2</td><td>80000</td></tr></tbody></table>\n<p>Then, we can join table <strong>Employee</strong> and <strong>Department</strong>, and query the (DepartmentId, Salary) are in the temp table using <code>IN</code> statement as below.</p>\n<h4>Implementation</h4>\n<pre><code>// Final SQL query represented in Java\nString sql = \n    \"SELECT Department.name AS Department, \" +\n    \"Employee.name AS Employee, Salary \" +\n    \"FROM Employee \" +\n    \"JOIN Department ON Employee.DepartmentId = Department.Id \" +\n    \"WHERE (Employee.DepartmentId, Salary) IN (\" +\n    \"    SELECT DepartmentId, MAX(Salary) \" +\n    \"    FROM Employee \" +\n    \"    GROUP BY DepartmentId\" +\n    \")\";</code></pre><svg><path></path></svg>",
        "isOfficial": true,
        "scrapedAt": "2026-02-18T07:43:27.753Z"
    }
}