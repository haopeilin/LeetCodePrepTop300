{"id":"204","title":"Count Primes","difficulty":"Medium","content":"<p>Given an integer <code>n</code>, return <em>the number of prime numbers that are strictly less than</em> <code>n</code>.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> n = 10\n<strong>Output:</strong> 4\n<strong>Explanation:</strong> There are 4 prime numbers less than 10, they are 2, 3, 5, 7.\n</pre>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<pre>\n<strong>Input:</strong> n = 0\n<strong>Output:</strong> 0\n</pre>\n\n<p><strong class=\"example\">Example 3:</strong></p>\n\n<pre>\n<strong>Input:</strong> n = 1\n<strong>Output:</strong> 0\n</pre>\n\n<p>&nbsp;</p>\n<p><strong>Constraints:</strong></p>\n\n<ul>\n\t<li><code>0 &lt;= n &lt;= 5 * 10<sup>6</sup></code></li>\n</ul>\n","tags":["Array","Math","Enumeration","Number Theory"],"java_snippet":"class Solution {\n    public int countPrimes(int n) {\n        \n    }\n}","solution":"<div class=\"flex flex-col w-full\" style=\"position: relative;\"><div class=\"mYe_l WRmCx\"><h2 class=\"group/heading relative\" id=\"solution\" level=\"2\"><a aria-hidden=\"true\" class=\"!text-sd-muted-foreground absolute right-full top-1/2 -translate-y-1/2 cursor-pointer pr-0.5 text-xs opacity-0 group-hover/heading:opacity-100\" href=\"#solution\" tabindex=\"-1\"><div class=\"relative text-[12px] leading-[normal] p-[1px] before:block before:h-3 before:w-3\"><svg aria-hidden=\"true\" class=\"svg-inline--fa fa-link absolute left-1/2 top-1/2 h-[1em] -translate-x-1/2 -translate-y-1/2 align-[-0.125em]\" data-icon=\"link\" data-prefix=\"fas\" focusable=\"false\" role=\"img\" spacing=\"square\" viewbox=\"0 0 640 512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z\" fill=\"currentColor\"></path></svg></div></a>Solution</h2>\n<hr/>\n<h3 class=\"group/heading relative\" id=\"overview\" level=\"3\"><a aria-hidden=\"true\" class=\"!text-sd-muted-foreground absolute right-full top-1/2 -translate-y-1/2 cursor-pointer pr-0.5 text-xs opacity-0 group-hover/heading:opacity-100\" href=\"#overview\" tabindex=\"-1\"><div class=\"relative text-[12px] leading-[normal] p-[1px] before:block before:h-3 before:w-3\"><svg aria-hidden=\"true\" class=\"svg-inline--fa fa-link absolute left-1/2 top-1/2 h-[1em] -translate-x-1/2 -translate-y-1/2 align-[-0.125em]\" data-icon=\"link\" data-prefix=\"fas\" focusable=\"false\" role=\"img\" spacing=\"square\" viewbox=\"0 0 640 512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z\" fill=\"currentColor\"></path></svg></div></a>Overview</h3>\n<p>The basic brute-force solution for this problem is to iterate from <code>0</code> to <code>n</code> and for each number, we do a prime-check. To check if a number is prime or not, we simply check if its divisors include anything other than <code>1</code> and the number itself. If so, then it is not a prime number. This method will not scale for the given limits on <code>n</code>. The iteration itself has <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> time complexity and for each iteration, we have the prime check which takes <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.0503em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8003em;\"><span class=\"svg-align\" style=\"top: -3em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"mord\" style=\"padding-left: 0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top: -2.7603em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"hide-tail\" style=\"min-width: 0.853em; height: 1.08em;\"><svg height=\"1.08em\" preserveaspectratio=\"xMinYMin slice\" viewbox=\"0 0 400000 1080\" width=\"400em\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2397em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>. This will exceed the problem's time limit.  Therefore, we need a more efficient solution.</p>\n<blockquote>\n<p>Instead of checking if each number is prime or not, what if we mark the multiples of a prime number as non-prime?</p>\n</blockquote>\n<br/>\n<hr/>\n<h3 class=\"group/heading relative\" id=\"approach-sieve-of-eratosthenes\" level=\"3\"><a aria-hidden=\"true\" class=\"!text-sd-muted-foreground absolute right-full top-1/2 -translate-y-1/2 cursor-pointer pr-0.5 text-xs opacity-0 group-hover/heading:opacity-100\" href=\"#approach-sieve-of-eratosthenes\" tabindex=\"-1\"><div class=\"relative text-[12px] leading-[normal] p-[1px] before:block before:h-3 before:w-3\"><svg aria-hidden=\"true\" class=\"svg-inline--fa fa-link absolute left-1/2 top-1/2 h-[1em] -translate-x-1/2 -translate-y-1/2 align-[-0.125em]\" data-icon=\"link\" data-prefix=\"fas\" focusable=\"false\" role=\"img\" spacing=\"square\" viewbox=\"0 0 640 512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z\" fill=\"currentColor\"></path></svg></div></a>Approach: Sieve of Eratosthenes</h3>\n<p><strong>Intuition</strong></p>\n<p>Suppose we are required to count the number of primes that are less than <code>21</code>. Start by creating an array that contains 21 integers (each index represents an integer).</p>\n<p></p>\n<p><em>Figure 1. An array of 21 integers which we'll use to mark primes and non-primes.</em></p>\n<p>Now, let's start with the smallest prime number we know, which is <code>2</code>. We mark the multiples of this number as non-primes in the array. To mark a number as non-prime, we set a sentinel value of <code>-1</code> in the array at the index corresponding to that number. E.g. the number <code>4</code> is not a prime number, so we mark <code>primes[4] = -1</code>.</p>\n<p></p>\n<p><em>Figure 2. Multiples of 2 marked as composites in the array.</em></p>\n<blockquote>\n<p>Now let's move on to the next available element in the array that has not yet been marked as a composite number. That number is 3, which is also a prime. Now, we repeat the same process with 3 i.e. we mark all the multiples (some will be repeats like 6) as composites.</p>\n</blockquote>\n<p></p>\n<p><em>Figure 3. Multiples of 3 are marked as composites in the array.</em></p>\n<p>At this point, you may notice that all of the numbers remaining in the array (that are not marked as composites) are primes.</p>\n<p></p>\n<p><em>Figure 4. Highlighting the remaining numbers as primes.</em></p>\n<blockquote>\n<p>We can start with the smallest prime number, 2, and mark all of its multiples up to \"n\" as non-primes.  Then we repeat the same process for the next available number in the array that is not marked as composite and so on.</p>\n</blockquote>\n<p>We have a nested-loop structure. Now the question is: <em>What are the bounds on these two loops?</em> The outer loop will start at <code>2</code> and go up to <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.04em; vertical-align: -0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8003em;\"><span class=\"svg-align\" style=\"top: -3em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"mord\" style=\"padding-left: 0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top: -2.7603em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"hide-tail\" style=\"min-width: 0.853em; height: 1.08em;\"><svg height=\"1.08em\" preserveaspectratio=\"xMinYMin slice\" viewbox=\"0 0 400000 1080\" width=\"400em\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2397em;\"><span></span></span></span></span></span></span></span></span></span>. This is because by that point we will have considered all of the possible multiples of all the prime numbers below <code>n</code>. Let's look at the example where <code>n</code> is <code>30</code>. Now the square-root of <code>n</code> is greater than <code>5</code>.</p>\n<pre>It is not necessary to consider any number greater than the square root of n. \n\n6 * 1 = 6 = 1 * 6\n6 * 2 = 12 = 2 * 6\n6 * 3 = 18 = 3 * 6\n6 * 4 = 24 = 2 * 12\n6 * 5 = 30 = 5 * 6\n6 * 6 = 36 &gt; 30\n\nNotice that every multiple of 6 was already addressed by some multiple of a prime number less than 6.\n</pre>\n<p>Now that the outer loop's boundaries are defined, let's define the boundaries of the inner loop. We will invariantly pick the next available prime number (a number/index not yet marked in the array as a composite) before entering the inner loop. Say the index we picked from the outer loop is <code>i</code>, then the inner loop will start at <code>i*i</code> and increase by increments of <code>i</code> until it surpasses <code>n</code>. In short, we iterate over every multiple of <code>i</code> between <code>i</code> and <code>n</code>.</p>\n<p>The question now is why should we start at <code>i*i</code>. Why not start at <code>2*i</code> to keep things simple? The reason is that all of the previous multiples would already have been covered by previous primes. In number theory, <a href=\"https://en.wikipedia.org/wiki/Fundamental_theorem_of_arithmetic\" target=\"_blank\">the fundamental theorem of arithmetic</a>, also called the unique factorization theorem or the unique prime factorization theorem, states that every integer greater than 1 either is a prime number itself or can be represented as the product of prime numbers. So the prime numbers smaller than <code>i</code> would have already covered the multiples smaller than <code>i*i</code>. Let's look at the prime number <code>7</code> to see how all the multiples up to <code>7*7</code> are already covered by primes smaller than '7'.</p>\n<pre>\nLet's assume that n is 50 (a value greater than 7*7) to demonstrate this claim. \n\n7 * 2 = 14 = 2 * 7\n7 * 3 = 21 = 3 * 7\n7 * 4 = 28 = 2 * 2 * 7 = 2 * 14\n7 * 5 = 35 = 5 * 7\n7 * 6 = 42 = 2 * 3 * 7 = 2 * 21\n</pre>\n<p><strong>Algorithm</strong></p>\n<p><a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" target=\"_blank\">Wikipedia</a> provides a great approach for this algorithm. So we will follow their method step by step to find all the prime numbers less than or equal to a given integer <code>n</code> by Eratosthenes' method:</p>\n<ol>\n<li data-length=\"1\">Create a list of consecutive integers from <code>2</code> through <code>n</code>: <code>(2, 3, 4, ..., n)</code>.</li>\n<li data-length=\"1\">Let <code>p</code> be the variable we use in the outer loop that iterates from <code>2</code> to <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.04em; vertical-align: -0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8003em;\"><span class=\"svg-align\" style=\"top: -3em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"mord\" style=\"padding-left: 0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top: -2.7603em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"hide-tail\" style=\"min-width: 0.853em; height: 1.08em;\"><svg height=\"1.08em\" preserveaspectratio=\"xMinYMin slice\" viewbox=\"0 0 400000 1080\" width=\"400em\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2397em;\"><span></span></span></span></span></span></span></span></span></span>. Initially, let <code>p</code> equal <code>2</code>, the smallest prime number.</li>\n<li data-length=\"1\">Enumerate the multiples of <code>p</code> by counting in increments of <code>p</code> from <code>p*p</code> to <code>n</code>, and mark them in the list (these will be <code>p*p</code>, <code>p*p + p</code>, <code>p*p + 2*p</code>, ...; <code>p</code> itself should be prime).</li>\n<li data-length=\"1\">Find the smallest number in the list greater than <code>p</code> that is not marked. If there was no such number, stop. Otherwise, let <code>p</code> now equal this new number (which is the next prime), and repeat from step 3.</li>\n<li data-length=\"1\">When the algorithm terminates, all of the remaining numbers that are not marked are prime.</li>\n</ol>\n<p>A key observation is that p will always be prime because every composite value less than p*p has already been marked as a multiple of some smaller prime. Note that some of the numbers may be marked more than once (e.g., <code>15</code> will be marked by both <code>3</code> and <code>5</code>).</p>\n<p><strong>Implementation Improvement (Theoretical)</strong></p>\n<p>The original algorithm advocates using an array to keep track of primes. However, if we do that, we will spend <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> space just to initialize the array and <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> time iterating over the array to count the primes. To avoid this, we will use a dictionary. There are two advantages to this:</p>\n<ol>\n<li data-length=\"1\">We don't need to iterate from <code>0..n</code> to initialize the dictionary. If a number is not a part of the dictionary, it is prime by definition.</li>\n<li data-length=\"1\">In the end, we can simply subtract the length of the dictionary (number of non-primes) from <code>n</code> to find the number of primes.</li>\n</ol>\n<p>For <code>n = 10</code>, the dictionary would contain <code>4, 6, 8, 9</code>. Excluding <code>1</code> and <code>10</code>, we have <code>10 - 2 - 4 = 4 primes</code>.</p>\n<p>This dictionary-based approach unfortunately does not execute within the time limit. Even though on paper it looks like it's worth saving the extra <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> space, in practice, the time required to evaluate and maintain the dictionary makes this approach impractical. So we will stick with the traditional array-based approach. This will add an additional <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> to the time complexity.</p>\n<p>Why does this happen you might ask? Well, it's probably because of the localization property of an array. An array is stored as a consecutive chunk of memory. The compiler can cache most of the array's elements in the RAM and other internal caches for super-fast access since these elements are right next to each other in memory. This is why it takes much less time to access elements in an array than to access elements in a dictionary.  Furthermore, this is what offsets the savings we see on paper regarding the overall complexity for the dictionary-based approach.</p>\n<p><strong>Implementation Improvement (Python Specific)</strong></p>\n<p>In most cases, for loops are fine, and sometimes they are more readable than built-in functions. However, for loops must be interpreted every iteration which makes them slower than some built-in alternatives that are implemented in C. <a href=\"https://stackoverflow.com/questions/24578896/python-built-in-sum-function-vs-for-loop-performance\" target=\"_blank\">Python Built-in Sum versus For Loop Performance</a></p>\n<p>In this problem, <code>n</code> may be very large and for every prime number less than or equal to <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.04em; vertical-align: -0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8003em;\"><span class=\"svg-align\" style=\"top: -3em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"mord\" style=\"padding-left: 0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top: -2.7603em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"hide-tail\" style=\"min-width: 0.853em; height: 1.08em;\"><svg height=\"1.08em\" preserveaspectratio=\"xMinYMin slice\" viewbox=\"0 0 400000 1080\" width=\"400em\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2397em;\"><span></span></span></span></span></span></span></span></span></span> we will iterate over all multiples of that number up to <code>n</code> and mark them as not prime. In the code below, this is done by using a for loop to iterate over every multiple of prime number <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span></span></span></span></span> between <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.0085em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8141em;\"><span style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span> and n. For readability, this implementation is presented below.</p>\n<details>\n<summary>However, by replacing the for loop with python's built-in method for accessing an array at every $$p^{th}$$ element, the runtime can be greatly reduced.  This faster implementation is provided here: (click)</summary>\n<br/>\n<div class=\"font-menlo mb-6 rounded-lg px-3 py-2.5 text-sm bg-fill-3 dark:bg-dark-fill-3\"><div class=\"group relative\" translate=\"no\"><pre style=\"color: black; font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent; overflow-wrap: normal;\"><code class=\"language-python\" style=\"white-space: pre; text-shadow: none;\"><span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">class</span><span> </span><span class=\"token\" style=\"color: rgb(221, 74, 104);\">Solution</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span>\n</span></span><span><span>    </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">def</span><span> </span><span class=\"token\" style=\"color: rgb(221, 74, 104);\">countPrimes</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span>self</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">,</span><span> n</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span> </span><span class=\"token\" style=\"color: rgb(102, 153, 0);\">int</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span><span> </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">-</span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">&gt;</span><span> </span><span class=\"token\" style=\"color: rgb(102, 153, 0);\">int</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span>\n</span></span><span><span>        </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">if</span><span> n </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">&lt;=</span><span> </span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">2</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span>\n</span></span><span><span>            </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">return</span><span> </span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">0</span><span>\n</span></span><span>\n</span><span><span>        </span><span class=\"token\" style=\"color: slategray;\"># Initialize numbers[0] and numbers[1] as False because 0 and 1 are not prime.</span><span>\n</span></span><span><span>        </span><span class=\"token\" style=\"color: slategray;\"># Initialze numbers[2] through numbers[n-1] as True because we assume each number</span><span>\n</span></span><span><span>        </span><span class=\"token\" style=\"color: slategray;\"># is prime until we find a prime number (p) that is a divisor of the number</span><span>\n</span></span><span><span>        numbers </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">=</span><span> </span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">[</span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">False</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">,</span><span> </span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">False</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">]</span><span> </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">+</span><span> </span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">[</span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">True</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">]</span><span> </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">*</span><span> </span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span>n </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">-</span><span> </span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">2</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span><span>\n</span></span><span><span>        </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">for</span><span> p </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">in</span><span> </span><span class=\"token\" style=\"color: rgb(102, 153, 0);\">range</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">2</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">,</span><span> </span><span class=\"token\" style=\"color: rgb(102, 153, 0);\">int</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span>sqrt</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span>n</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span><span> </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">+</span><span> </span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">1</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span>\n</span></span><span><span>            </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">if</span><span> numbers</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">[</span><span>p</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">]</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span>\n</span></span><span><span>                </span><span class=\"token\" style=\"color: slategray;\"># Set all multiples of p to false because they are not prime.</span><span>\n</span></span><span><span>                </span><span class=\"token\" style=\"color: slategray;\"># There are ceil(n / p - p) numbers between p*p and n that are multiples of p.</span><span>\n</span></span><span><span>                numbers</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">[</span><span>p </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">*</span><span> p </span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span> n </span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">:</span><span> p</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">]</span><span> </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">=</span><span> </span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">[</span><span class=\"token\" style=\"color: rgb(153, 0, 85);\">False</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">]</span><span> </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">*</span><span> math</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">.</span><span>ceil</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span>n </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">/</span><span> p </span><span class=\"token\" style=\"color: rgb(154, 110, 58);\">-</span><span> p</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span><span>\n</span></span><span>\n</span><span><span>        </span><span class=\"token\" style=\"color: slategray;\"># numbers[index] will only be true where index is a prime number</span><span>\n</span></span><span><span>        </span><span class=\"token\" style=\"color: slategray;\"># return the number of indices whose value is true.</span><span>\n</span></span><span><span>        </span><span class=\"token\" style=\"color: rgb(0, 119, 170);\">return</span><span> </span><span class=\"token\" style=\"color: rgb(102, 153, 0);\">sum</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">(</span><span>numbers</span><span class=\"token\" style=\"color: rgb(153, 153, 153);\">)</span></span></code></pre><div class=\"absolute -right-1.5 -top-0.5 flex gap-2\"><div class=\"z-base-1 hidden rounded border group-hover:block border-border-quaternary dark:border-border-quaternary bg-layer-02 dark:bg-layer-02\"><div class=\"relative cursor-pointer flex h-[22px] w-[22px] items-center justify-center bg-layer-02 dark:bg-layer-02 hover:bg-fill-tertiary dark:hover:bg-fill-tertiary rounded-[4px]\" data-state=\"closed\"><div><div data-state=\"closed\"><div class=\"relative text-[12px] leading-[normal] p-[1px] before:block before:h-3 before:w-3 h-3.5 w-3.5 text-text-primary dark:text-text-primary\"><svg aria-hidden=\"true\" class=\"svg-inline--fa fa-clone absolute left-1/2 top-1/2 h-[1em] -translate-x-1/2 -translate-y-1/2 align-[-0.125em]\" data-icon=\"clone\" data-prefix=\"far\" focusable=\"false\" role=\"img\" viewbox=\"0 0 512 512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M64 464H288c8.8 0 16-7.2 16-16V384h48v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64h64v48H64c-8.8 0-16 7.2-16 16V448c0 8.8 7.2 16 16 16zM224 304H448c8.8 0 16-7.2 16-16V64c0-8.8-7.2-16-16-16H224c-8.8 0-16 7.2-16 16V288c0 8.8 7.2 16 16 16zm-64-16V64c0-35.3 28.7-64 64-64H448c35.3 0 64 28.7 64 64V288c0 35.3-28.7 64-64 64H224c-35.3 0-64-28.7-64-64z\" fill=\"currentColor\"></path></svg></div></div></div></div></div></div></div></div>\n</details>\n<br/>\n<pre><code>class Solution {\npublic:\n    int countPrimes(int n) {\n        if (n &lt;= 2) {\n            return 0;\n        }\n​\n        vector&lt;bool&gt; numbers(n, true);  // Initialize vector with n true values\n        for (int p = 2; p &lt;= sqrt(n); ++p) {\n            if (numbers[p]) {\n                for (int j = p * p; j &lt; n; j += p) {\n                    numbers[j] = false;\n                }\n            }\n        }\n​\n        int numberOfPrimes = 0;\n        for (int i = 2; i &lt; n; i++) {\n            if (numbers[i]) {\n                ++numberOfPrimes;\n            }\n        }\n​\n        return numberOfPrimes;\n    }\n};</code></pre>\n<p><strong>Complexity Analysis</strong></p>\n<ul>\n<li>\n<p>Time Complexity: The overall time complexity is <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.0503em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8003em;\"><span class=\"svg-align\" style=\"top: -3em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"mord\" style=\"padding-left: 0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top: -2.7603em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"hide-tail\" style=\"min-width: 0.853em; height: 1.08em;\"><svg height=\"1.08em\" preserveaspectratio=\"xMinYMin slice\" viewbox=\"0 0 400000 1080\" width=\"400em\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2397em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right: 0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right: 0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span>. The <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6667em; vertical-align: -0.0833em;\"></span><span class=\"mord\">+</span><span class=\"mord mathnormal\">n</span></span></span></span></span> is from calculating the answer after the main algorithm. The <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.04em; vertical-align: -0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8003em;\"><span class=\"svg-align\" style=\"top: -3em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"mord\" style=\"padding-left: 0.833em;\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top: -2.7603em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"hide-tail\" style=\"min-width: 0.853em; height: 1.08em;\"><svg height=\"1.08em\" preserveaspectratio=\"xMinYMin slice\" viewbox=\"0 0 400000 1080\" width=\"400em\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"></path></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2397em;\"><span></span></span></span></span></span></span></span></span></span> comes from the outer loop. Each time we hit a prime, we \"cross out\" the multiples of that prime because we know they aren't prime. But how many iterations do we perform for each prime number? That depends on how many multiples of that number are lower than <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></span>. Let's look at a rough estimate of these values for all the primes.</p>\n<pre>  For 2, we have to cross out n/2 numbers.\n  For 3, we have to cross out n/3 numbers.\n  For 5, we have to cross out n/5 numbers.\n  ...etc for each prime less than n.\n  </pre>\n<p>This means that the time complexity of \"crossing out\" is <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.095em; vertical-align: -0.345em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6954em;\"><span style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.0404em; vertical-align: -0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6954em;\"><span style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.0404em; vertical-align: -0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6954em;\"><span style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span></span></span></span><span style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.6667em; vertical-align: -0.0833em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.2311em; vertical-align: -0.4811em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6954em;\"><span style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">last prime &lt; n</span></span></span></span></span><span style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.4811em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></span>. This is bounded by <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right: 0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right: 0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> and the proof is available <a href=\"http://www.cs.umd.edu/~gasarch/BLOGPAPERS/sump.pdf\" target=\"_blank\">here</a>. Cheers to this <a href=\"https://bit.ly/3fgqsE0\" target=\"_blank\">discussion</a> post for explaining the complexity analysis in a detailed manner!</p>\n</li>\n<li>\n<p>Space Complexity: <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span> because we use an array of length <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6667em; vertical-align: -0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span> to track primes and their multiples. If you use a dictionary instead of an array, you will still end up marking at least <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.0404em; vertical-align: -0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6954em;\"><span style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span> elements as composites of the number <code>2</code>. Thus, the overall complexity when using a dictionary is also <span class=\"math math-inline\"><span class=\"katex\"><span aria-hidden=\"true\" class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span>.</p>\n</li>\n</ul></div><span style=\"font-size: 0px; line-height: 0;\"> </span></div>"}