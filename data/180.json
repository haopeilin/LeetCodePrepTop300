{"id":"180","title":"Consecutive Numbers","difficulty":"Medium","content":"<p>Table: <code>Logs</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| id          | int     |\n| num         | varchar |\n+-------------+---------+\nIn SQL, id is the primary key for this table.\nid is an autoincrement column starting from 1.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Find all numbers that appear at least three times consecutively.</p>\n\n<p>Return the result table in <strong>any order</strong>.</p>\n\n<p>The&nbsp;result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nLogs table:\n+----+-----+\n| id | num |\n+----+-----+\n| 1  | 1   |\n| 2  | 1   |\n| 3  | 1   |\n| 4  | 2   |\n| 5  | 1   |\n| 6  | 2   |\n| 7  | 2   |\n+----+-----+\n<strong>Output:</strong> \n+-----------------+\n| ConsecutiveNums |\n+-----------------+\n| 1               |\n+-----------------+\n<strong>Explanation:</strong> 1 is the only number that appears consecutively for at least three times.\n</pre>\n","tags":["Database"],"java_snippet":"","solution":"<h2><a href=\"#solution\"><svg><path></path></svg></a>Solution</h2>\n<hr/>\n<h3><a href=\"#approach-using-distinct-and-where-clause-accepted\"><svg><path></path></svg></a>Approach: Using <code>DISTINCT</code> and <code>WHERE</code> clause [Accepted]</h3>\n<p><strong>Algorithm</strong></p>\n<p>Consecutive appearing means the Id of the Num are next to each others. Since this problem asks for numbers appearing at least three times consecutively, we can use 3 aliases for this table <strong>Logs</strong>, and then check whether 3 consecutive numbers are all the same.</p>\n<pre><code>class Log {\n    int id;\n    int num;\n\n    Log(int id, int num) {\n        this.id = id;\n        this.num = num;\n    }\n}\n\nList&lt;Log&gt; logs = List.of(\n    new Log(1, 1),\n    new Log(2, 1),\n    new Log(3, 1)\n);\n\n// Simulate l1, l2, l3 aliases and WHERE conditions\nfor (int i = 0; i &lt; logs.size() - 2; i++) {\n    Log l1 = logs.get(i);\n    Log l2 = logs.get(i + 1);\n    Log l3 = logs.get(i + 2);\n\n    if (l1.id == l2.id - 1\n            &amp;&amp; l2.id == l3.id - 1\n            &amp;&amp; l1.num == l2.num\n            &amp;&amp; l2.num == l3.num) {\n        System.out.println(\n            l1.id + \" \" + l1.num + \" | \"\n            + l2.id + \" \" + l2.num + \" | \"\n            + l3.id + \" \" + l3.num\n        );\n    }\n}</code></pre><svg><path></path></svg>\n<table><thead><tr><th>Id</th><th>Num</th><th>Id</th><th>Num</th><th>Id</th><th>Num</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>2</td><td>1</td><td>3</td><td>1</td></tr></tbody></table>\n<blockquote>\n<p>Note: The first two columns are from l1, then the next two are from l2, and the last two are from l3.</p>\n</blockquote>\n<p>Then we can select any <em>Num</em> column from the above table to get the target data. However, we need to add a keyword <code>DISTINCT</code> because it will display a duplicated number if one number appears more than 3 times consecutively.</p>\n<p><strong>Java</strong></p>\n<pre><code>Set&lt;Integer&gt; consecutiveNums = new HashSet&lt;&gt;();\n\nfor (int i = 0; i &lt; logs.size() - 2; i++) {\n    Log l1 = logs.get(i);\n    Log l2 = logs.get(i + 1);\n    Log l3 = logs.get(i + 2);\n\n    if (l1.id == l2.id - 1\n            &amp;&amp; l2.id == l3.id - 1\n            &amp;&amp; l1.num == l2.num\n            &amp;&amp; l2.num == l3.num) {\n        consecutiveNums.add(l1.num); // DISTINCT behavior\n    }\n}\n\nfor (int num : consecutiveNums) {\n    System.out.println(num);\n}</code></pre><svg><path></path></svg>"}