{"id":"176","title":"Second Highest Salary","difficulty":"Medium","content":"<p>Table: <code>Employee</code></p>\n\n<pre>\n+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| id          | int  |\n| salary      | int  |\n+-------------+------+\nid is the primary key (column with unique values) for this table.\nEach row of this table contains information about the salary of an employee.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write a solution to find&nbsp;the second highest <strong>distinct</strong> salary from the <code>Employee</code> table. If there is no second highest salary,&nbsp;return&nbsp;<code>null (return&nbsp;None in Pandas)</code>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nEmployee table:\n+----+--------+\n| id | salary |\n+----+--------+\n| 1  | 100    |\n| 2  | 200    |\n| 3  | 300    |\n+----+--------+\n<strong>Output:</strong> \n+---------------------+\n| SecondHighestSalary |\n+---------------------+\n| 200                 |\n+---------------------+\n</pre>\n\n<p><strong class=\"example\">Example 2:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nEmployee table:\n+----+--------+\n| id | salary |\n+----+--------+\n| 1  | 100    |\n+----+--------+\n<strong>Output:</strong> \n+---------------------+\n| SecondHighestSalary |\n+---------------------+\n| null                |\n+---------------------+\n</pre>\n","tags":["Database"],"java_snippet":"","solution":"<h1><a href=\"#solution\"><svg><path></path></svg></a>Solution</h1>\n<hr/>\n<h2><a href=\"#pandas\"><svg><path></path></svg></a>pandas</h2>\n<h3><a href=\"#approach-sorting\"><svg><path></path></svg></a>Approach: Sorting</h3>\n<h4>Algorithm</h4>\n<p>Given the table <code>employee</code> as follows:</p>\n<table><tbody><tr><th>id</th><th>salary</th></tr><tr><td>1</td><td>100</td></tr><tr><td>2</td><td>200</td></tr><tr><td>3</td><td>300</td></tr><tr><td>4</td><td>200</td></tr></tbody></table>\n<br/>\n<p>We first drop any duplicate salaries.</p>\n<table><tbody><tr><th>id</th><th>salary</th></tr><tr><td>1</td><td>100</td></tr><tr><td>2</td><td>200</td></tr><tr><td>3</td><td>300</td></tr></tbody></table>\n<br/>\n<p>Then we handle the case if there are less than two unique salaries. If there are less than two unique salaries, then we return <code>null</code> as the second highest salary. Otherwise, we sort the table by salary in descending order.</p>\n<table><tbody><tr><th>id</th><th>salary</th></tr><tr><td>3</td><td>300</td></tr><tr><td>2</td><td>200</td></tr><tr><td>1</td><td>100</td></tr></tbody></table>\n<br/>\nThen we drop the `id` column.\n<table><tbody><tr><th>salary</th></tr><tr><td>300</td></tr><tr><td>200</td></tr><tr><td>100</td></tr></tbody></table>\n<br/>\nRename the salary column to `SecondHighestSalary` \n<table><tbody><tr><th>SecondHighestSalary</th></tr><tr><td>300</td></tr><tr><td>200</td></tr><tr><td>100</td></tr></tbody></table>\n<br/>\nNow we get the first two rows.\n<table><tbody><tr><th>SecondHighestSalary</th></tr><tr><td>300</td></tr><tr><td>200</td></tr></tbody></table>\n<br/>\nThe last of which is the second highest salary.\n<table><tbody><tr><th>SecondHighestSalary</th></tr><tr><td>200</td></tr></tbody></table>\n<br/>\n<h4>Implementation</h4>\n<pre><code>import java.util.*;\nimport java.util.stream.*;\n\nclass Employee {\n    int id;\n    int salary;\n\n    Employee(int id, int salary) {\n        this.id = id;\n        this.salary = salary;\n    }\n}\n\npublic class Solution {\n    public static Integer secondHighestSalary(List&lt;Employee&gt; employees) {\n        // 1. Drop any duplicate salaries.\n        List&lt;Integer&gt; uniqueSalaries = employees.stream()\n                .map(e -&gt; e.salary)\n                .distinct()\n                .collect(Collectors.toList());\n\n        // 2. If there are less than two unique salaries, return null.\n        if (uniqueSalaries.size() &lt; 2) {\n            return null;\n        }\n\n        // 3. Sort salaries in descending order.\n        uniqueSalaries.sort(Comparator.reverseOrder());\n\n        // 4, 5, 6, 7. Return the second highest salary.\n        return uniqueSalaries.get(1);\n    }\n}</code></pre>\n<hr/>\n<br/>\n<h2><a href=\"#database\"><svg><path></path></svg></a>Database</h2>\n<h3><a href=\"#approach-1-using-sub-query-and-limit-clause\"><svg><path></path></svg></a>Approach 1: Using sub-query and <code>LIMIT</code> clause</h3>\n<h4>Algorithm</h4>\n<p>Sort the distinct salary in descend order and then utilize the <a href=\"https://dev.mysql.com/doc/refman/5.7/en/select.html\"><code>LIMIT</code></a> clause to get the second highest salary.</p>\n<pre><code>String sql =\n    \"SELECT DISTINCT Salary AS SecondHighestSalary \" +\n    \"FROM Employee \" +\n    \"ORDER BY Salary DESC \" +\n    \"LIMIT 1 OFFSET 1\";</code></pre><svg><path></path></svg>\n<p>However, this solution will be judged as 'Wrong Answer' if there is no such second highest salary since there might be only one record in this table. To overcome this issue, we can take this as a temp table. The complete code is as follows:</p>\n<h4>Implementation</h4>\n<pre><code>String sql =\n    \"SELECT (\" +\n    \"  SELECT DISTINCT Salary \" +\n    \"  FROM Employee \" +\n    \"  ORDER BY Salary DESC \" +\n    \"  LIMIT 1 OFFSET 1\" +\n    \") AS SecondHighestSalary\";</code></pre><svg><path></path></svg>\n<h3><a href=\"#approach-2-using-ifnull-and-limit-clause\"><svg><path></path></svg></a>Approach 2: Using <code>IFNULL</code> and <code>LIMIT</code> clause</h3>\n<h4>Algorithm</h4>\n<p>Another way to solve the 'NULL' problem is to use <code>IFNULL</code> function as below. The <code>IFNULL</code> function will return the first argument if it is not <code>NULL</code>, otherwise it returns the second argument.<br/>\nThis gives us the correct solution of <em>one row</em> containing <code>NULL</code> (if there is no such second highest salary) instead of just an empty table.</p>\n<h4>Implementation</h4>\n<pre><code>String sql =\n    \"SELECT IFNULL((\" +\n    \"  SELECT DISTINCT Salary \" +\n    \"  FROM Employee \" +\n    \"  ORDER BY Salary DESC \" +\n    \"  LIMIT 1 OFFSET 1\" +\n    \"), NULL) AS SecondHighestSalary\";</code></pre><svg><path></path></svg>"}